{% extends "base.html" %}
{% load i18n %} 

{% block extra_scripts %}
<script>

$.ajaxSetup({
	  data: {csrfmiddlewaretoken: '{{ csrf_token }}' },
	});
	
$.post("/resource/rate/", { rating: 3, resource_id: {{ resource.id }} },
    function(data) {
       // success! so now set the UI star to 3
});
</script>
{% endblock extra_scripts %}


{% block content %}

<h2 style="text-align:center">{{ resource.title }}</h2>

{% include "includes/messages.html" %}

<p style="text-align:center">
From:
{% for o in resource.get_organisations %}
	{% if o.url %}
		<a href="{{ o.url }}" target="_blank">{{ o.name }} </a>
	{% else %}
		{{ o.name }}
	{% endif %}

{% endfor %}
</p>
{% if resource.image %}
	<img src="{% url 'mpowering_resource_image' resource.id 250 %}" style="display:block; margin: 20px auto; max-width: 250px" class="thumbnail"/>
{% endif %}
<p>
{{ resource.description|safe }}
</p>



{% if resource.get_files %}
	<hr/>
	<h4>{% trans 'Files' %}</h4>
	<ul>
	{% for f in resource.get_files %}
		<li>
			{% if f.description and f.description.strip %}
				<a href="{% url 'mpowering_resource_view_file' f.id %}">{{ f.description }}</a>
			{% else %}
				<a href="{% url 'mpowering_resource_view_file' f.id %}">{{ f.filename }}</a>
			{% endif %}
		</li>
	{% endfor %}
	</ul>
{% endif %}

{% if resource.get_urls %}
	<hr/>
	<h4>{% trans 'Links' %}</h4>
	<ul>
	{% for u in resource.get_urls %}
		<li>
			{% if u.description %}
				<a href="{% url 'mpowering_resource_view_link' u.id %}">{{ u.description }}</a>
			{% else %}
				<a href="{% url 'mpowering_resource_view_link' u.id %}">{{ u.url }}</a>
			{% endif %}
		</li>
	{% endfor %}
	</ul>
{% endif %}

{% if resource.get_categories %}
	{% for c in resource.get_categories %}
		<hr/>
		
		<h4>{{ c.name }}</h4>
		<ul>
			{% for t in c.tags %}
				<li><a href="{% url 'mpowering_tags' t.slug %}">{{ t.name }}</a></li>
			{% endfor %}
		</ul>
	{% endfor %}
{% endif %}

<hr/>
<small>Resource uploaded by {{ resource.create_user.first_name }} {{ resource.create_user.last_name }} ({{ resource.create_date }})
and last updated by {{ resource.update_user.first_name }} {{ resource.update_user.last_name }} ({{ resource.update_date }})</small>

<hr/>
<p>Resource viewed {{ resource.get_no_hits }} times </p>


{% if options_menu %}
<hr/>
	{% for om in options_menu %}
		<a class="btn btn-primary btn btn-default" href="{{ om.url }}">{{ om.title }}</a>
	{% endfor %}
{% endif %}
{% endblock %}